#include "CppUnitTest.h"

#include "opencl_utilities.h"
#include "single_device_context.h"
#include "Utilities.h"
#include "ReverseComplementConfig.h"

#include "CL/opencl.h"
#include <iostream>

using std::string;
using std::cout;
using std::endl;

using namespace Microsoft::VisualStudio::CppUnitTestFramework;

namespace ReverseComplementTests
{
	TEST_CLASS(ReverseComplement_OpenCL)
	{
		char * reverseComplement(const char * dna, char * cdna = nullptr, size_t length = 0) {

			OCL_STATUS_INITIALIZE;

			// access the desired platform and device
			cl_platform_id platform_id = ocl::get_platform_id(ocl::DeviceTraits<ProjectDevice>::PlatformName);
			cl_device_id device_id = ocl::get_device_id(platform_id, ocl::DeviceTraits<ProjectDevice>::DeviceType);

			// create a context and queue for the device
			cl_context context = OCL_CHECK(clCreateContext(nullptr, 1, &device_id, nullptr, nullptr, &OCL_STATUS));
			cl_command_queue queue = OCL_CHECK(clCreateCommandQueue(context, device_id, 0, &OCL_STATUS));

			// create the program from an opencl binary file or a source file
			cl_program program;
			if (ocl::DeviceTraits<ProjectDevice>::UseBinary) {
				auto binary = ocl::read_opencl_binary(R"(D:\Accelerators\OpenCL\OpenCL_Features\ReverseComplement.Tests\altera\ReverseComplement.aocx)");
				auto binarySize = binary.size();
				unsigned char const * binaryData = &binary[0];
				program = OCL_CHECK(clCreateProgramWithBinary(context, 1, &device_id, &binarySize, &binaryData, nullptr, &OCL_STATUS));
			} else {
				string sourceString = ocl::read_opencl_source("ReverseComplement.cl");
				char const * sourceChars = sourceString.c_str();
				program = OCL_CHECK(clCreateProgramWithSource(context, 1, &sourceChars, nullptr, &OCL_STATUS));
			}

			// compile the opencl program and report errors
			OCL_CHECK_BUILD(clBuildProgram(program, 1, &device_id, "", nullptr, nullptr), program, device_id);
				
			//create the kernel
			cl_kernel kernel = OCL_CHECK(clCreateKernel(program, "reverse_complement", &OCL_STATUS));
				
			// determine size of input and output buffers
			size_t bufferSize = length > 0 ? length : strlen(dna);

			// allocate space on host for cdna if not provided
			if (cdna == nullptr) cdna = new char[bufferSize + 1];

			// create input buffer for dna and queue copying of data to device
			cl_mem deviceDNA = OCL_CHECK(clCreateBuffer(context, CL_MEM_READ_ONLY, bufferSize, nullptr, &OCL_STATUS));
			OCL_CHECK(clEnqueueWriteBuffer(queue, deviceDNA, CL_FALSE, 0, bufferSize, dna, 0, nullptr, nullptr));

			// create output buffer for cdna
			cl_mem deviceCDNA = OCL_CHECK(clCreateBuffer(context, CL_MEM_WRITE_ONLY, bufferSize, nullptr, &OCL_STATUS));

			// set kernel arguments
			OCL_CHECK(clSetKernelArg(kernel, 0, sizeof(cl_mem), &deviceDNA));
			OCL_CHECK(clSetKernelArg(kernel, 1, sizeof(cl_mem), &deviceCDNA));
			OCL_CHECK(clSetKernelArg(kernel, 2, sizeof(int), &bufferSize));

			// queue execution of kernel using a one-dimensional range of work items
			size_t globalWorkSize[1] = { bufferSize };
			OCL_CHECK(clEnqueueNDRangeKernel(queue, kernel, 1, nullptr, globalWorkSize, nullptr, 0, nullptr, nullptr));
			
			//  queue copy of output buffer from device to host and wait for all queued commands
			OCL_CHECK(clEnqueueReadBuffer(queue, deviceCDNA, CL_TRUE, 0, bufferSize, cdna, 0, nullptr, nullptr));

			// release all OpenCL resources
			OCL_CHECK(clReleaseKernel(kernel));
			OCL_CHECK(clReleaseMemObject(deviceCDNA));
			OCL_CHECK(clReleaseMemObject(deviceDNA));
			OCL_CHECK(clReleaseProgram(program));
			OCL_CHECK(clReleaseCommandQueue(queue));
			OCL_CHECK(clReleaseContext(context));

			// terminate cdna on host and return
			cdna[bufferSize] = '\0';
			return cdna;
		}

	public:
		
		TEST_METHOD(TestReverseComplement_SampleShort)
		{
			Assert::AreEqual(
				"ACCGGGTTTT",
				reverseComplement("AAAACCCGGT"));
		}

		TEST_METHOD(TestReverseComplement_SampleLong)
		{
			Assert::AreEqual(
				"CCACCGCAAAATATATTAACGATAAACCTGTTCAGACCTAATGGGCCGCCGTGTGTTCGTGGGGAGGCCAGGCAACTTTGTATGATCGCTGCCTCTCACATCTGTACAGGCCCGCCGTGGGAACATGAGCATTCCCGGGTGCGAATAGACGTGTTTGTGATTTTGGACCACCCCTGACATTCACCCCGAAATAACACCACTCTATACGGTAGTGATTGCTCGAGTGCAGCCACAGCTCTACCTGGCTGAGGCCCAGTCTACCGCATGTGCTGCTATACGAGTTTTTGCTAAAATTTAGACTAGCCTTCGAGGGCTTGATTAGGAGAATATCTGGGCGACCACTAACTAATAGCGTCCGAACGTTCGTCTCTGGTCATCCCCGAGGAGGTAGAGCATTATCCTGATATACCCACCTGCTGTGGGGGCCGGCCGTCAGCAGCGCCAAGCTTTATGTGTGCTTGTGCCATGTATTGGGCTCCTTTGTTCGAGTGTTATTCAATTTCCGAAAACTTAGACCGTTCGCTATGTCCGGTTGGTAGGTAAGTTTTTAGGGCCGGAATAGTGCCTCGTAAGGATTGGGAGGACGAGATCTGAGGAGCGGCCGAGTCGCGGACTGCTTGCACTTATAGACAGTCATAAACCAGTCTACACTTATCGTCACCAAGAATCCCCGGGAGGTCACCGCCAGGGCTCGCTTAAACCTGGAATGAATCAGACAAGGGCTGATCGGTTCGACGTAAATCCTTGTTGTTTGACGCCTCCCCCACACGAAACCCTTTCTCACACCGGTGACTTTCTCTGGCGTCTTACCGGCCCAATGGAAGAATTAGCTCTAAGCCTGCCATAGTGCTTGTGCTCACAGGAACATCATGTATCCTGGGGCGTCCCCTGTCCATGGCTCGATTCCAAGAGCTGTGTGGTCGTTAATGAGCAACACTGTGGCTGGATACCACCGTCGTCCCGAGTGATAAGCGATCCAACCTTCGCCCCCACTAGGGTGCCGATATACTTTGATGTTACATTACAGGTACATACGCTTTGCTATCACAAGATGCTGACGTTGCCACGAGCGCGGGGTGCCTAGGATCACCAAAGTGTAGACAAATGCTCAAGGGCCGCGTGGTATCTAGGGCAATAGCTAAGGCACAATACTATGTTCCGGGGTATTCCCCCCAATACTCGGCCGTATTGCCAACGCTGTCTTGAGCTGACAAAGAACTGGATAGTCTCATTCCTATACATCCTACTGGTCGGGAATGAAAGGTGACTCTTCCTGATATTATACCTGTATGCTAATCTAGGGTGTCCTGCACCGAATCAAATAGGTTGAACGTGCTTCGGGGACTCGCTCGCAGGCGAGAGGAGATGGAGACCAACCCTTTCGCAAAAAAGATCCTAACTCATATTTGCTGGGAGCCTCGCTCCGATTTCTATTCTAACATCTTTGCTCGTTGACGATTGCCCTCCGAAACAGTAACACAGCCTTGCCTTTATCTGGAACCAACGATTCGCTGCGCATTCGTCAACTCCGAGTGACCGTGCGCCGCCATTAAAATCTCGGACATGAGCTTTTTTGTTGTAAAGGATGTGCCGACTACAGCTCAGTCAGTATCCGAAGAGCCGCGGAATGGGGCTACAAAGCCAAAGTCTCTGCGTGCCCGGTCACCCTCTCTCAGCGAAGTGCATAAAGAACGTTGGGACTATCTCTTTCTATAATACGGCGGTTCCGCGACCCTATCGTTGATCCTACAATTCCCTACCGGATAAACACTGAGCTTCAACTGGTCGGACTCAACGACTCTTTACGGAAAAATGATTACTAGCTAAGTGTTCGCGTGGATGTTACATCTCGTGATTTGACCCTCCATATTCTTCGACTTTGACGCAACTCACCCTCATACTGATGTTGTCAACTCCACAATGCTGAATGAACCTTATTCTTCAGTTTTCGTCTCGGTTTTGGATTTCTTATACGACCGCCAAGTGTCGGTGAGCGGGCGTAATGCGGCTGTTGGGGTGTGACACGCTCAAGCTAGGTCGGGGGTGGGCTAGACCTAAGGGGGCAAAGCCCCAGAATGGCTTATGCCGGTATGTGGCGAGTCGTAAAAGCGGAGATTCGGTATAATCAGAGTTCGGGTCCATCGGACTTTTCGTTCGTTGCGCAGCGTCGACCGCGACGCTGAAGACATCGTATTTTGATATAGCCACTTCCCAAGTTAATCGTTGGTTCCCAGATCGACTCCAAATTGCATACACCACTTATTATTGAAGGCGTGGCAGGATAGAATGCAGATTGTGCAAACTTCTAAGCTTAGGGAGCGCGCGGCACGTGATCAACTTTCATGGTAGTACATCCGCAGGGCGACCGTGATCAACCGTACTCACAGAACACCCGGAAGGCGAGCATTAGTGCGTGTCAGCCTAACGATTCCCGCAAGTCATCTTGACAACTTTTATCCCTATACAGCGTAAGGCACTGTCTAGTCTCGCTGGTGCTTTAGTGC",
				reverseComplement("GCACTAAAGCACCAGCGAGACTAGACAGTGCCTTACGCTGTATAGGGATAAAAGTTGTCAAGATGACTTGCGGGAATCGTTAGGCTGACACGCACTAATGCTCGCCTTCCGGGTGTTCTGTGAGTACGGTTGATCACGGTCGCCCTGCGGATGTACTACCATGAAAGTTGATCACGTGCCGCGCGCTCCCTAAGCTTAGAAGTTTGCACAATCTGCATTCTATCCTGCCACGCCTTCAATAATAAGTGGTGTATGCAATTTGGAGTCGATCTGGGAACCAACGATTAACTTGGGAAGTGGCTATATCAAAATACGATGTCTTCAGCGTCGCGGTCGACGCTGCGCAACGAACGAAAAGTCCGATGGACCCGAACTCTGATTATACCGAATCTCCGCTTTTACGACTCGCCACATACCGGCATAAGCCATTCTGGGGCTTTGCCCCCTTAGGTCTAGCCCACCCCCGACCTAGCTTGAGCGTGTCACACCCCAACAGCCGCATTACGCCCGCTCACCGACACTTGGCGGTCGTATAAGAAATCCAAAACCGAGACGAAAACTGAAGAATAAGGTTCATTCAGCATTGTGGAGTTGACAACATCAGTATGAGGGTGAGTTGCGTCAAAGTCGAAGAATATGGAGGGTCAAATCACGAGATGTAACATCCACGCGAACACTTAGCTAGTAATCATTTTTCCGTAAAGAGTCGTTGAGTCCGACCAGTTGAAGCTCAGTGTTTATCCGGTAGGGAATTGTAGGATCAACGATAGGGTCGCGGAACCGCCGTATTATAGAAAGAGATAGTCCCAACGTTCTTTATGCACTTCGCTGAGAGAGGGTGACCGGGCACGCAGAGACTTTGGCTTTGTAGCCCCATTCCGCGGCTCTTCGGATACTGACTGAGCTGTAGTCGGCACATCCTTTACAACAAAAAAGCTCATGTCCGAGATTTTAATGGCGGCGCACGGTCACTCGGAGTTGACGAATGCGCAGCGAATCGTTGGTTCCAGATAAAGGCAAGGCTGTGTTACTGTTTCGGAGGGCAATCGTCAACGAGCAAAGATGTTAGAATAGAAATCGGAGCGAGGCTCCCAGCAAATATGAGTTAGGATCTTTTTTGCGAAAGGGTTGGTCTCCATCTCCTCTCGCCTGCGAGCGAGTCCCCGAAGCACGTTCAACCTATTTGATTCGGTGCAGGACACCCTAGATTAGCATACAGGTATAATATCAGGAAGAGTCACCTTTCATTCCCGACCAGTAGGATGTATAGGAATGAGACTATCCAGTTCTTTGTCAGCTCAAGACAGCGTTGGCAATACGGCCGAGTATTGGGGGGAATACCCCGGAACATAGTATTGTGCCTTAGCTATTGCCCTAGATACCACGCGGCCCTTGAGCATTTGTCTACACTTTGGTGATCCTAGGCACCCCGCGCTCGTGGCAACGTCAGCATCTTGTGATAGCAAAGCGTATGTACCTGTAATGTAACATCAAAGTATATCGGCACCCTAGTGGGGGCGAAGGTTGGATCGCTTATCACTCGGGACGACGGTGGTATCCAGCCACAGTGTTGCTCATTAACGACCACACAGCTCTTGGAATCGAGCCATGGACAGGGGACGCCCCAGGATACATGATGTTCCTGTGAGCACAAGCACTATGGCAGGCTTAGAGCTAATTCTTCCATTGGGCCGGTAAGACGCCAGAGAAAGTCACCGGTGTGAGAAAGGGTTTCGTGTGGGGGAGGCGTCAAACAACAAGGATTTACGTCGAACCGATCAGCCCTTGTCTGATTCATTCCAGGTTTAAGCGAGCCCTGGCGGTGACCTCCCGGGGATTCTTGGTGACGATAAGTGTAGACTGGTTTATGACTGTCTATAAGTGCAAGCAGTCCGCGACTCGGCCGCTCCTCAGATCTCGTCCTCCCAATCCTTACGAGGCACTATTCCGGCCCTAAAAACTTACCTACCAACCGGACATAGCGAACGGTCTAAGTTTTCGGAAATTGAATAACACTCGAACAAAGGAGCCCAATACATGGCACAAGCACACATAAAGCTTGGCGCTGCTGACGGCCGGCCCCCACAGCAGGTGGGTATATCAGGATAATGCTCTACCTCCTCGGGGATGACCAGAGACGAACGTTCGGACGCTATTAGTTAGTGGTCGCCCAGATATTCTCCTAATCAAGCCCTCGAAGGCTAGTCTAAATTTTAGCAAAAACTCGTATAGCAGCACATGCGGTAGACTGGGCCTCAGCCAGGTAGAGCTGTGGCTGCACTCGAGCAATCACTACCGTATAGAGTGGTGTTATTTCGGGGTGAATGTCAGGGGTGGTCCAAAATCACAAACACGTCTATTCGCACCCGGGAATGCTCATGTTCCCACGGCGGGCCTGTACAGATGTGAGAGGCAGCGATCATACAAAGTTGCCTGGCCTCCCCACGAACACACGGCGGCCCATTAGGTCTGAACAGGTTTATCGTTAATATATTTTGCGGTGG"));
		}

		TEST_METHOD(TestReverseComplement_Quiz)
		{
			auto results = reverseComplement(
				"ATATTGCGTATCAAGAGGGGTACTGCAGATGTGGAAACATAGTCTGTAGAACTTAGAGCTGCCACCTAAATCGTGAGTTCCCCACCGACAGTCTACCCATTACAATTCGGCCGCGAACGAATCGAGCACCCTAGCTGTGGCTAGATAACGCCGGGTACCCGAGGCAACGTGAATAGAGTGCTGTCCAAACGTGTTAGCAACTGATACTTCTCTCATCTTCCGCTTTCCAGCGTAAGATACAAAAGTGACTGGACAAGACATACTTACAAACTTGTGCCGTGAACCGTTGACACTGGCTCACTGGACAAGTGTTGACGACGCGGGGCTGTTATACATCCTGCGAGGTCTACACCGCCAGACTAGAAAGATGCAAAGCGGGTATTTGGGAGTAGTTCATCACAGTCCAAGGTTAACCAGCCGGGACATACGCGGTTGCCGTAGAATCAATGAACCTGCTTGACCTCGGGACGTTTTGTTAGACCAGCCGTTAGTCCCGTATATTCGAGTTTTGTGGTATAAGGACGGTCTCCTCATGTCCCGAGGGGACCGTTTCCGTAAATATTTACATTAAGTCTGAAAGCAAGGGCCATGTGTAGTGTACCGGGGCAGTAATTTTCGACTTTCAACCGGCGAGTTCGTGTAGGTTGCGGGCCTCAACCGGTTGTAAAAGCTGCCGCTCGCCCGTCCAATGAATCATCTTAAAGTAGTAATCCAATGAAAGAATGCACGTCCAGATGGCGAACTCAGTTCTACAACCACGTGGTTAACGTGTGTCTTGATAAAGCAGGGGGCTCGTACGGGCCAGCCACATCAGCCCCTATAATGCCGCAGCCTGGCCTCTCACAGACGGCAGGGCTGGCTGTACGATTAGTGTGCTCTTTACGACATGGTGGAGAACCTCCGTATGGGATTCGCTGTGAGCTTTCAGAATGAGTATGATCGGCACCAGACCCCTATAAATTGCAATCAGGCATGACAGAGACTGAGCGACAGGGCTCACGTGGAAAGTAGTTGACTGTTCACCCCGATCCCCGCGCAATCGAGCCTTTGTCCAATTACTGCAAGTTTCGGGGAGGCGGTGCTCTGCATATACGTTATGCTGAAGCCGCCTTCCAATGTGCCGAGCAACCCCTTCCGCACTACTCCTACCTCTTTGACTCTCATGGTCGTACGTGTGTGGCTTTCGACCTCTGTCCACAGGGATTTGAACGGTAGATGACACGCATATTTGGGCGCGCTGCTCTATGTGTATGCAATCCATCTGGCGCGCGAGTAACACAGTGGGCTTCTCAGCAGGGGATATTTCTAACCGTTCGTAACGATTCAAGCATGAGGGAGCCTCGTAATTAGCGGTAGCTGTGGGCGTATTCCCCAGTCTCGAAACAACTTCTGCAACTGAAGGCACTGGACACGTTTTAGCTGCATCGCCCAAGTCTGCGTTGCTACTTAGGCTGAAAACTTAGACCCATCGAAGTCATACTGATCGACCACAGATTAGGCTTATTATTTCACTTGATCGTGGCATGGTCAATTCAAGCCAATGGTGATTAACGGCCTAACTGAAGGTATGAAAAAGAGAGTATCAACTTTCGGAACGCAAAGTCGCCGGAGGCACAAGGGCCCCCTATTTGGGAACACAATAAGGCCATGCCCTCCTCAAACATGGTGTTACGGCTTAATACCGCCTGATAGCCTGTTATAACTGACGGCCATGGCAGGCACAGCCAAAGATTTGTTAGCGGGTGAACTGAGAGACGCAGAATATGGTCTAAGGTACTATAGGCTACCATAGGTGGGGATTCGATACGTGTTCACGCCTACAAATCCCTAAGGTTGAAACACAGACACGTAGTCACTCCGAACGTCCATCAAATGACTAGAGCCGTCCCTGGCTGCTAGTGCAATTATGATGGAGAGAGACCCGTTAACTTCAAGAGTATCAATTCAATGGTACCACGGTAGGATCGCGACTAACACGGCTAGCCATCAGGCAAATTCGACAATTAGATCACAGTCAACCTGTGCCTACTCACCTGCGTGTGTCTATACCCAGCCGATTTCTTAATTTCTTGACGGGTCGTTCCTATTAACGTTCCAAGCGGCAGGATCTTCCCGATTATTATTTCACGACTTGAGGAAGATAGGGTTTTAGTCAGGCGAACTTAGCTAAACGTTCGTTAGCATCTCGCGGATTGGCATAAAAAGCGTTTTAGTTCTTCGAGGAAGAATGTTTATCTACGCAGCCCAGCCCAATTTCGTTAGACGCCAGCGTGGTAGCGTCCTATGTACGGATGGAGCAGCTTGTTGCAGATTGAAAATACCACAGAGTAGCCCACCAATGTTTTTTCTGACTTAGGTAGAAAGAAAAGCGCATTAGCGTGACGGGCATATACGTCGCAAGTAGCGATCACCAAATGTTCAGACACTCCGCAAAGCTTCCCCCCGCCCTCAGTAGAAGGCCACCTTTACGCCATGGTAGAGCAGACTTCTTGTCCCATCTCTGCAGATACCTAAAGAACGACACGCTAGGGAGTTCCGCGGCTGCCTATCGTAACATCTAGACAGTCCTAATTTCCCGAGCCATATCCGTGTAGGAACGTGAGACTGAATTTTACTTGACGGGCGTGTAACAGATGATGATCGCGAATTACATAGTAAGAGTGTTCCTATTCGCTCTTGTCGCGGTGTGATCCAATTATAGCATCGGAGTCTCGTTCGGCATCGGCCTCGACCGACACTAGCATTATAGATGACACAGCACCCAGTACGGTCCAGCGGGCATAGGAGGGAGAGAAAAAACTTTCCTAGCCGAAGGTCTGAAACCCCTAACCTTCATAGCTCGCGTGTAAAGAGGCTGTGCAGGTCCCAAAATAGATCCCTCGGTCATGGGGTCCAGGAATGAGAACACGAGCCGTTAAGGCTTGAAATCGATATTCGACTAGAAACAAGTAGCTCCTTCTACCTTGGGATAGTACATAGTCCGCGCACATATCCGAGGAAGGGACCCCCGCAACTCCTCACTGCGGCTTTCAGCACGCCCTAGGGGAATTATAACGGCCATTCTTATCGTCATCGGGGGACCTATCACATGCTACTACCACTTCAATATTCTTTGACCCCCAGCTCCGGCCATGGATGGGCGTTATCATGAAACGCTAACAGTCGGCTCTCCCCAAATATCTAGTTACTCTCCTCAAACTCTTTCGGTACGCAATCTAAAGATTCATTGACAACTGCCCGGACCTACTGACGAATCTTACGGTCCAGGGATATCTATAGCAATTCATTACGCCGACGCACCTGAATGGGTCACTGACTTCTAACCGGTCAGTATGGGCTAAGCTGCAGCCCTCCCGTCTTGTGGAGCGATACTGCACAGTGCAAGAAATGATACCTGCGTTTTACTCCCTAAACGGCAACTACTTTCATCGACCTTCGGTCGGGCTGTACGCTGCCCCAGGTAGGGAGTGTAACTCTCCTTTCATTATGAACACCATGATGACGCGCTAGCAGAGGGCTCGTGAGACCTGCCTACGACGGCCGTTGTCAACAAGCCTTCGGCGATTCAGATGGCTTATCAAAACGGTTCGTATTTATAGGACCCAGGGCTGAGTTCCAGTGCTATTAGGATCGGATGGAATGGCCCTAATGAGGCGACGGATAACTATCTGTCAAAGTTCTGTCCACGATTCCTGTTTCATAGAAGATTTAATTCACTCGTTCCAGCTGTGAGCCCGCCAGTGTAGGGCTAGAATATCGGTAGCCCTTGAATGGATCCGGTGTTAACTTGCTATATTATGCTCCTAGCGTACAGTGCGGCGGGCGTATCATCGTAGCTATAACCGGGAGGGCTAATCAGACCAGAGAAGTCGCGATCAGTGAAGGTGTATTATTACTAGTGAAGCAATCGAAAATGAGGCAGTGTAAATGCTTCTCCTCTCCGCGCCACCAGACACATCTCTACGGAAGCATGAAACGAGGACTTCCCCAGCTTCGTGGGTGTACCCTCTGTACACGCAAAGGATCCTCCGCTTGATTTCGTCCGACGACCTAAACCGGAAAGGCGCTACTAACGACGATGATAGAAATACTATAACGCTAGTACGGTGGAATTTGTGACGCGCCCTCAATACACAGTTAGGGACGGACTGGCTTAATTTCGCGACAGTGATCTTCCGTTACGACGGTTAGGCATTTTGGACCCGATCGGGACGCACTGAGAGGGTGTATCGGCCTGGCATGGGTTCTAAGGTCTGAAGGGCCCCTATCCATAATATTGTTCACCTGACAGATAGTGGAGTTGGGTTCCCCATCGCATACCGCTGCTAGCACGGTTCTCGGATCGAAGCCCATCGTACTAGTCGGGCTGCATCTCAGAAGCATGGTGGCAAGACGGGTCTGGTTGACATTGGGGCGTCTGGTTGGCGAGAGGCTCTATACCAGAAACCTAATTTACCATTGTGGAATCGAACTCTAGGTGAGCGGGCTACCGGTGGACCCTAGCGTCGCGACCCGCGCGGTAGAATGCTCGCATTCCAAAACTACAGATTTCAGATCACGACCCGTGAACCATGGCCCAAGACCTTAAGGCAGAACGCAGTCCCTCGGGCCGATATTAGTACTTGAGCAAGTACCAGCCGGTCTTTTACTGTCCTTTGGATAATTTTGCACAGCAGTTAGGTACTGAGTCATGAGAACTATGTTTCGGGATCATAGGTATGAAGTCACATAGCCAGGCTCCTTCAAAGGAGGTCTGAGAAACTCGCCTACATGGAATACTGTACCGGCGAATAAGCATTGCGCCGTATTGTCGGGGGGAAACTACTTGTTAACTCGCAACTGCAGTTTTGCCCGTCATGAGTCGTGCCGTGCTGTCGGGTCGTCCTGAACCGGGCTGCTTTTAGTTCAAGCATTACTTCGTTGCTCGTTACAAGCCACGTTTATATATGAGGACGCCAGATGCACTACAGTGTCAAATCTAGCTTACTTTGAGACCTTATGCCACTTTCGCGCCCCAAGGACTCGGGTCTCGGGTTTGCTACTTCGGTGGGTGGGTTTCTCAAATCGTATGAGTATCAACTGGGGTTTCTTTACTATATCAGAGAGGAGTACTCGCGAAGGTGAGGGGCAGTTGTACACGGGGATGATCGACCGTGTGCCCAAGCCCTGAATGTATTGTTGAAATGTGGCATGCTGGATGCAGGGGGAGCCCGACACCAACCTTTCAAACAGAAGGAGGTGGAGTGTGTACCTAGTGTCAGTGTCTAACCATTGAGTGGACAAAGTTGGTTCCTGACCCAAGTGTCTGGTCTCATAATGGTGATAGTTAAGAGTTGTACACGGACGTGTGACCTGGAAATCAACAACGACCACTTCGAGCTCGGTCAATGTCTCGATCCATTGAGAAAGCGACACAAAGGCAGTCGTCCCCGACGACCCTAGGCTCGAAATCTGTTAGCCCTTCCGCGATGATGTCTAATTTCCGTGTGATTAAGTATCTAACATCTCTGCTATAACAGAAAGACTACGTTACAGTTTGCGGAGTTCTATGCACGATGTATGCTCATTTTTTGTACTTTACATTACATGTGCCTGTGACGAGTACGTCTAAGACCTCTGAGCAGGAGTGGGAGCATGACCTGGAACCATATTCGCAGCAGCGACCCGCCGATTAGCGCTGATGCGCGAACGGTAGCCAGGTGTATACGGTACATGTTGTAACCCACCAGGACGCGACTAGCCTTATGAAGGTGAGGGAATCTTGTTAGAATTCATCAGCATACAGTCTATAGGGGTGCTTCTGGGCTGCGACCATCAATAGGCCCGGCTCCTTGGCGCCCGGCGGCTCAACCACAAGGTATATAAATGCTTGCGGCTGGCTATTAATCTGCTCGTAGATAACAAATAGTCCGTCTAGTTCCTTGCTGGATCCAGGAGGAATCACACCATAATCAGCCTGGCCGCGGCAGTAGAACAGTAGGAAACTACTTCTACCATAAACAAACCGGGCCGAAACTGCAAATCGGTTCAAGCAGCCGAGTTCTGAGTCTTCACATCCCGCCCAACCCGTGCGAGTTCTCGCGGATGAGGACGCATAGGGGTGACCCGATCAGACATCAGACGAAACCACGCAGACCCTGAAGACCAGATTCCGTCACCCAAGATGTCCTCCGGGTCCGATAAACCGCCGAGTCCTACCGATCATCAGACAGAACAGAGGTATCTCGCATCGGGCGGACTCTCATTCCAGTCTTCCAGGATGAGTGAGCCTCCAGAAGCCTCCTATTAAAATAAGCTCAGACGCCCAAGGCCTAGGAAAATCTCGTAAGGTTGGCCTTAGTCTATCTGCGTCATGCTCATTCTCTCGAACAGGTGGGTTACGCTCAGAATGAACATTGGAGGAGGGCGAGCATATGGGCAGTGTTTTGAAGCATCAAGTTTTATTACTTTTGTACTTTTTCCCAGTTAGTTCCCGTTGGTGCAAATTAACACATCAAGATAGATATGTGACGGACGGTGCCTTCCCTTGCGGTGAGCGTGCTGATGGTGCCGAGCTACACGTTGGCGCTGTTTGGACGATGGGTAATGTAATCTCCATTACGGATCGAGCTTACTTCTAAAACATGAGTAACACTTTTTACGCCCCTTAGTAATGCCCTCGATTTCTTGGTCGCACATCAATCTAAAACTGCGGCTGATCGAATATCAAAACAATCATCATACCATAACGTCGATGCGTGACGCTCGCTTGACTGGACTCATGGTCTTTTATAAAGGAGTCCGGGCGATGCGTTATGAGCACAGTCTTGGGCTCATTTTTCACTAGAGCAATTAGGAAAGGGAATCGGGAGAAGGCCTATTTCGTCATCGGCCCATGCTAGATAACACACTTGGCCGTGTCCCAGCCCGAGACGTACAGCATTTACCAGGGTAATGACGCATTCTGCTCAGCCTATAGGACGTAAGGTACTGGCAATATGGAGTGGACTTTGTGGATCCAGATCGTAGTATATCATTTTCCGTATTCACACAAGGGCGTTCACCCGCCTCCCTAGCGTAGTCAATCTACGACGGTGACCGTGTTGTTCATCAGTTGGCGCGGTCTGAGGCCCTGACTCACTACCCGCACATGCTCGGTTTTGCCTCTCCATTGTTGCACGGATAACGCTTGACCTAGATCAAGGCCGACTTACTCGTCATGCAGGTGTATGGCCTAGTGGTCGTCCCTCCGACTACCATGTCCTTGAGTGAAGCCAGTGGCCCCCGCAATCGGGAACAGCGTAACGGAGCTGAGGGATATAGTCGGAACGATGTTGACCTCGGTTTGCCTCCACTTTCGTGGTCCATAGAGGTGTACCCTCAGTGCATCGGAGGCGGAATGGGCCCGTGTATTTAGGCTAACAGGACACCAGAAATTTATGAAACCTCTACCATCCATCTTACCCTGGGCATCTATCCTGGCCCTCGCGATCTGATGCGCTAGTACACCGCACCCATGAACACATATACCCTAGCCCTACGAACCCCGATAGTTCCTCGAATGGGCACTGCGTCGATTAAAATAGTATATGTCCTGCGAAGCACAAGTAATAAGTGATGTTTTCACACCCGCAGTTCCAATCGCTTTGTCCGACGGAGCCCAACGAGCACTGGTGATCAAACATCTATAGCGACCTGATGGTGTTCGAAAATCTCGCAGTAGTCGCTCTGCGAGGGGTCAGTCTCGGAAAGATGCGGACAATAGAACGTCAGCGAGCGCGACATTTTGATAAATAAATACCGCGTACTTTTGTATCTCTGTCCAGAGTCACAACTCGAGTCGCCAAGTGCCTCGAGAGCGAGTGTCCCCCCGGGACTCGGGCATGATCACAACGAAGATGATGATTGATCGATAATTGTTACCAGTTTGGGTGTCTTGTCGATACCGGTCCATTAATGGAGCATCTGTTGAATAGGTTACAACCGTTTACTAACGGCATCCGGGGTAATATCTGTCGCATGTATGATTTGGTTCTGCTGGTGGTGTATCCCAGCCTCGATTCTTTAGCAACGGGTGTTCCGCGCGGCTTCGACCTTTCCACCCACTCCTACCATCAGTGGAAACACAGGGTTTAACCAACCCAGGTTCTCTTCAAGGCTAGATTCCGTATTGCATGCAGTGGACTTACAAG");
			Assert::AreEqual(
				"CTTGTAAGTCCACTGCATGCAATACGGAATCTAGCCTTGAAGAGAACCTGGGTTGGTTAAACCCTGTGTTTCCACTGATGGTAGGAGTGGGTGGAAAGGTCGAAGCCGCGCGGAACACCCGTTGCTAAAGAATCGAGGCTGGGATACACCACCAGCAGAACCAAATCATACATGCGACAGATATTACCCCGGATGCCGTTAGTAAACGGTTGTAACCTATTCAACAGATGCTCCATTAATGGACCGGTATCGACAAGACACCCAAACTGGTAACAATTATCGATCAATCATCATCTTCGTTGTGATCATGCCCGAGTCCCGGGGGGACACTCGCTCTCGAGGCACTTGGCGACTCGAGTTGTGACTCTGGACAGAGATACAAAAGTACGCGGTATTTATTTATCAAAATGTCGCGCTCGCTGACGTTCTATTGTCCGCATCTTTCCGAGACTGACCCCTCGCAGAGCGACTACTGCGAGATTTTCGAACACCATCAGGTCGCTATAGATGTTTGATCACCAGTGCTCGTTGGGCTCCGTCGGACAAAGCGATTGGAACTGCGGGTGTGAAAACATCACTTATTACTTGTGCTTCGCAGGACATATACTATTTTAATCGACGCAGTGCCCATTCGAGGAACTATCGGGGTTCGTAGGGCTAGGGTATATGTGTTCATGGGTGCGGTGTACTAGCGCATCAGATCGCGAGGGCCAGGATAGATGCCCAGGGTAAGATGGATGGTAGAGGTTTCATAAATTTCTGGTGTCCTGTTAGCCTAAATACACGGGCCCATTCCGCCTCCGATGCACTGAGGGTACACCTCTATGGACCACGAAAGTGGAGGCAAACCGAGGTCAACATCGTTCCGACTATATCCCTCAGCTCCGTTACGCTGTTCCCGATTGCGGGGGCCACTGGCTTCACTCAAGGACATGGTAGTCGGAGGGACGACCACTAGGCCATACACCTGCATGACGAGTAAGTCGGCCTTGATCTAGGTCAAGCGTTATCCGTGCAACAATGGAGAGGCAAAACCGAGCATGTGCGGGTAGTGAGTCAGGGCCTCAGACCGCGCCAACTGATGAACAACACGGTCACCGTCGTAGATTGACTACGCTAGGGAGGCGGGTGAACGCCCTTGTGTGAATACGGAAAATGATATACTACGATCTGGATCCACAAAGTCCACTCCATATTGCCAGTACCTTACGTCCTATAGGCTGAGCAGAATGCGTCATTACCCTGGTAAATGCTGTACGTCTCGGGCTGGGACACGGCCAAGTGTGTTATCTAGCATGGGCCGATGACGAAATAGGCCTTCTCCCGATTCCCTTTCCTAATTGCTCTAGTGAAAAATGAGCCCAAGACTGTGCTCATAACGCATCGCCCGGACTCCTTTATAAAAGACCATGAGTCCAGTCAAGCGAGCGTCACGCATCGACGTTATGGTATGATGATTGTTTTGATATTCGATCAGCCGCAGTTTTAGATTGATGTGCGACCAAGAAATCGAGGGCATTACTAAGGGGCGTAAAAAGTGTTACTCATGTTTTAGAAGTAAGCTCGATCCGTAATGGAGATTACATTACCCATCGTCCAAACAGCGCCAACGTGTAGCTCGGCACCATCAGCACGCTCACCGCAAGGGAAGGCACCGTCCGTCACATATCTATCTTGATGTGTTAATTTGCACCAACGGGAACTAACTGGGAAAAAGTACAAAAGTAATAAAACTTGATGCTTCAAAACACTGCCCATATGCTCGCCCTCCTCCAATGTTCATTCTGAGCGTAACCCACCTGTTCGAGAGAATGAGCATGACGCAGATAGACTAAGGCCAACCTTACGAGATTTTCCTAGGCCTTGGGCGTCTGAGCTTATTTTAATAGGAGGCTTCTGGAGGCTCACTCATCCTGGAAGACTGGAATGAGAGTCCGCCCGATGCGAGATACCTCTGTTCTGTCTGATGATCGGTAGGACTCGGCGGTTTATCGGACCCGGAGGACATCTTGGGTGACGGAATCTGGTCTTCAGGGTCTGCGTGGTTTCGTCTGATGTCTGATCGGGTCACCCCTATGCGTCCTCATCCGCGAGAACTCGCACGGGTTGGGCGGGATGTGAAGACTCAGAACTCGGCTGCTTGAACCGATTTGCAGTTTCGGCCCGGTTTGTTTATGGTAGAAGTAGTTTCCTACTGTTCTACTGCCGCGGCCAGGCTGATTATGGTGTGATTCCTCCTGGATCCAGCAAGGAACTAGACGGACTATTTGTTATCTACGAGCAGATTAATAGCCAGCCGCAAGCATTTATATACCTTGTGGTTGAGCCGCCGGGCGCCAAGGAGCCGGGCCTATTGATGGTCGCAGCCCAGAAGCACCCCTATAGACTGTATGCTGATGAATTCTAACAAGATTCCCTCACCTTCATAAGGCTAGTCGCGTCCTGGTGGGTTACAACATGTACCGTATACACCTGGCTACCGTTCGCGCATCAGCGCTAATCGGCGGGTCGCTGCTGCGAATATGGTTCCAGGTCATGCTCCCACTCCTGCTCAGAGGTCTTAGACGTACTCGTCACAGGCACATGTAATGTAAAGTACAAAAAATGAGCATACATCGTGCATAGAACTCCGCAAACTGTAACGTAGTCTTTCTGTTATAGCAGAGATGTTAGATACTTAATCACACGGAAATTAGACATCATCGCGGAAGGGCTAACAGATTTCGAGCCTAGGGTCGTCGGGGACGACTGCCTTTGTGTCGCTTTCTCAATGGATCGAGACATTGACCGAGCTCGAAGTGGTCGTTGTTGATTTCCAGGTCACACGTCCGTGTACAACTCTTAACTATCACCATTATGAGACCAGACACTTGGGTCAGGAACCAACTTTGTCCACTCAATGGTTAGACACTGACACTAGGTACACACTCCACCTCCTTCTGTTTGAAAGGTTGGTGTCGGGCTCCCCCTGCATCCAGCATGCCACATTTCAACAATACATTCAGGGCTTGGGCACACGGTCGATCATCCCCGTGTACAACTGCCCCTCACCTTCGCGAGTACTCCTCTCTGATATAGTAAAGAAACCCCAGTTGATACTCATACGATTTGAGAAACCCACCCACCGAAGTAGCAAACCCGAGACCCGAGTCCTTGGGGCGCGAAAGTGGCATAAGGTCTCAAAGTAAGCTAGATTTGACACTGTAGTGCATCTGGCGTCCTCATATATAAACGTGGCTTGTAACGAGCAACGAAGTAATGCTTGAACTAAAAGCAGCCCGGTTCAGGACGACCCGACAGCACGGCACGACTCATGACGGGCAAAACTGCAGTTGCGAGTTAACAAGTAGTTTCCCCCCGACAATACGGCGCAATGCTTATTCGCCGGTACAGTATTCCATGTAGGCGAGTTTCTCAGACCTCCTTTGAAGGAGCCTGGCTATGTGACTTCATACCTATGATCCCGAAACATAGTTCTCATGACTCAGTACCTAACTGCTGTGCAAAATTATCCAAAGGACAGTAAAAGACCGGCTGGTACTTGCTCAAGTACTAATATCGGCCCGAGGGACTGCGTTCTGCCTTAAGGTCTTGGGCCATGGTTCACGGGTCGTGATCTGAAATCTGTAGTTTTGGAATGCGAGCATTCTACCGCGCGGGTCGCGACGCTAGGGTCCACCGGTAGCCCGCTCACCTAGAGTTCGATTCCACAATGGTAAATTAGGTTTCTGGTATAGAGCCTCTCGCCAACCAGACGCCCCAATGTCAACCAGACCCGTCTTGCCACCATGCTTCTGAGATGCAGCCCGACTAGTACGATGGGCTTCGATCCGAGAACCGTGCTAGCAGCGGTATGCGATGGGGAACCCAACTCCACTATCTGTCAGGTGAACAATATTATGGATAGGGGCCCTTCAGACCTTAGAACCCATGCCAGGCCGATACACCCTCTCAGTGCGTCCCGATCGGGTCCAAAATGCCTAACCGTCGTAACGGAAGATCACTGTCGCGAAATTAAGCCAGTCCGTCCCTAACTGTGTATTGAGGGCGCGTCACAAATTCCACCGTACTAGCGTTATAGTATTTCTATCATCGTCGTTAGTAGCGCCTTTCCGGTTTAGGTCGTCGGACGAAATCAAGCGGAGGATCCTTTGCGTGTACAGAGGGTACACCCACGAAGCTGGGGAAGTCCTCGTTTCATGCTTCCGTAGAGATGTGTCTGGTGGCGCGGAGAGGAGAAGCATTTACACTGCCTCATTTTCGATTGCTTCACTAGTAATAATACACCTTCACTGATCGCGACTTCTCTGGTCTGATTAGCCCTCCCGGTTATAGCTACGATGATACGCCCGCCGCACTGTACGCTAGGAGCATAATATAGCAAGTTAACACCGGATCCATTCAAGGGCTACCGATATTCTAGCCCTACACTGGCGGGCTCACAGCTGGAACGAGTGAATTAAATCTTCTATGAAACAGGAATCGTGGACAGAACTTTGACAGATAGTTATCCGTCGCCTCATTAGGGCCATTCCATCCGATCCTAATAGCACTGGAACTCAGCCCTGGGTCCTATAAATACGAACCGTTTTGATAAGCCATCTGAATCGCCGAAGGCTTGTTGACAACGGCCGTCGTAGGCAGGTCTCACGAGCCCTCTGCTAGCGCGTCATCATGGTGTTCATAATGAAAGGAGAGTTACACTCCCTACCTGGGGCAGCGTACAGCCCGACCGAAGGTCGATGAAAGTAGTTGCCGTTTAGGGAGTAAAACGCAGGTATCATTTCTTGCACTGTGCAGTATCGCTCCACAAGACGGGAGGGCTGCAGCTTAGCCCATACTGACCGGTTAGAAGTCAGTGACCCATTCAGGTGCGTCGGCGTAATGAATTGCTATAGATATCCCTGGACCGTAAGATTCGTCAGTAGGTCCGGGCAGTTGTCAATGAATCTTTAGATTGCGTACCGAAAGAGTTTGAGGAGAGTAACTAGATATTTGGGGAGAGCCGACTGTTAGCGTTTCATGATAACGCCCATCCATGGCCGGAGCTGGGGGTCAAAGAATATTGAAGTGGTAGTAGCATGTGATAGGTCCCCCGATGACGATAAGAATGGCCGTTATAATTCCCCTAGGGCGTGCTGAAAGCCGCAGTGAGGAGTTGCGGGGGTCCCTTCCTCGGATATGTGCGCGGACTATGTACTATCCCAAGGTAGAAGGAGCTACTTGTTTCTAGTCGAATATCGATTTCAAGCCTTAACGGCTCGTGTTCTCATTCCTGGACCCCATGACCGAGGGATCTATTTTGGGACCTGCACAGCCTCTTTACACGCGAGCTATGAAGGTTAGGGGTTTCAGACCTTCGGCTAGGAAAGTTTTTTCTCTCCCTCCTATGCCCGCTGGACCGTACTGGGTGCTGTGTCATCTATAATGCTAGTGTCGGTCGAGGCCGATGCCGAACGAGACTCCGATGCTATAATTGGATCACACCGCGACAAGAGCGAATAGGAACACTCTTACTATGTAATTCGCGATCATCATCTGTTACACGCCCGTCAAGTAAAATTCAGTCTCACGTTCCTACACGGATATGGCTCGGGAAATTAGGACTGTCTAGATGTTACGATAGGCAGCCGCGGAACTCCCTAGCGTGTCGTTCTTTAGGTATCTGCAGAGATGGGACAAGAAGTCTGCTCTACCATGGCGTAAAGGTGGCCTTCTACTGAGGGCGGGGGGAAGCTTTGCGGAGTGTCTGAACATTTGGTGATCGCTACTTGCGACGTATATGCCCGTCACGCTAATGCGCTTTTCTTTCTACCTAAGTCAGAAAAAACATTGGTGGGCTACTCTGTGGTATTTTCAATCTGCAACAAGCTGCTCCATCCGTACATAGGACGCTACCACGCTGGCGTCTAACGAAATTGGGCTGGGCTGCGTAGATAAACATTCTTCCTCGAAGAACTAAAACGCTTTTTATGCCAATCCGCGAGATGCTAACGAACGTTTAGCTAAGTTCGCCTGACTAAAACCCTATCTTCCTCAAGTCGTGAAATAATAATCGGGAAGATCCTGCCGCTTGGAACGTTAATAGGAACGACCCGTCAAGAAATTAAGAAATCGGCTGGGTATAGACACACGCAGGTGAGTAGGCACAGGTTGACTGTGATCTAATTGTCGAATTTGCCTGATGGCTAGCCGTGTTAGTCGCGATCCTACCGTGGTACCATTGAATTGATACTCTTGAAGTTAACGGGTCTCTCTCCATCATAATTGCACTAGCAGCCAGGGACGGCTCTAGTCATTTGATGGACGTTCGGAGTGACTACGTGTCTGTGTTTCAACCTTAGGGATTTGTAGGCGTGAACACGTATCGAATCCCCACCTATGGTAGCCTATAGTACCTTAGACCATATTCTGCGTCTCTCAGTTCACCCGCTAACAAATCTTTGGCTGTGCCTGCCATGGCCGTCAGTTATAACAGGCTATCAGGCGGTATTAAGCCGTAACACCATGTTTGAGGAGGGCATGGCCTTATTGTGTTCCCAAATAGGGGGCCCTTGTGCCTCCGGCGACTTTGCGTTCCGAAAGTTGATACTCTCTTTTTCATACCTTCAGTTAGGCCGTTAATCACCATTGGCTTGAATTGACCATGCCACGATCAAGTGAAATAATAAGCCTAATCTGTGGTCGATCAGTATGACTTCGATGGGTCTAAGTTTTCAGCCTAAGTAGCAACGCAGACTTGGGCGATGCAGCTAAAACGTGTCCAGTGCCTTCAGTTGCAGAAGTTGTTTCGAGACTGGGGAATACGCCCACAGCTACCGCTAATTACGAGGCTCCCTCATGCTTGAATCGTTACGAACGGTTAGAAATATCCCCTGCTGAGAAGCCCACTGTGTTACTCGCGCGCCAGATGGATTGCATACACATAGAGCAGCGCGCCCAAATATGCGTGTCATCTACCGTTCAAATCCCTGTGGACAGAGGTCGAAAGCCACACACGTACGACCATGAGAGTCAAAGAGGTAGGAGTAGTGCGGAAGGGGTTGCTCGGCACATTGGAAGGCGGCTTCAGCATAACGTATATGCAGAGCACCGCCTCCCCGAAACTTGCAGTAATTGGACAAAGGCTCGATTGCGCGGGGATCGGGGTGAACAGTCAACTACTTTCCACGTGAGCCCTGTCGCTCAGTCTCTGTCATGCCTGATTGCAATTTATAGGGGTCTGGTGCCGATCATACTCATTCTGAAAGCTCACAGCGAATCCCATACGGAGGTTCTCCACCATGTCGTAAAGAGCACACTAATCGTACAGCCAGCCCTGCCGTCTGTGAGAGGCCAGGCTGCGGCATTATAGGGGCTGATGTGGCTGGCCCGTACGAGCCCCCTGCTTTATCAAGACACACGTTAACCACGTGGTTGTAGAACTGAGTTCGCCATCTGGACGTGCATTCTTTCATTGGATTACTACTTTAAGATGATTCATTGGACGGGCGAGCGGCAGCTTTTACAACCGGTTGAGGCCCGCAACCTACACGAACTCGCCGGTTGAAAGTCGAAAATTACTGCCCCGGTACACTACACATGGCCCTTGCTTTCAGACTTAATGTAAATATTTACGGAAACGGTCCCCTCGGGACATGAGGAGACCGTCCTTATACCACAAAACTCGAATATACGGGACTAACGGCTGGTCTAACAAAACGTCCCGAGGTCAAGCAGGTTCATTGATTCTACGGCAACCGCGTATGTCCCGGCTGGTTAACCTTGGACTGTGATGAACTACTCCCAAATACCCGCTTTGCATCTTTCTAGTCTGGCGGTGTAGACCTCGCAGGATGTATAACAGCCCCGCGTCGTCAACACTTGTCCAGTGAGCCAGTGTCAACGGTTCACGGCACAAGTTTGTAAGTATGTCTTGTCCAGTCACTTTTGTATCTTACGCTGGAAAGCGGAAGATGAGAGAAGTATCAGTTGCTAACACGTTTGGACAGCACTCTATTCACGTTGCCTCGGGTACCCGGCGTTATCTAGCCACAGCTAGGGTGCTCGATTCGTTCGCGGCCGAATTGTAATGGGTAGACTGTCGGTGGGGAACTCACGATTTAGGTGGCAGCTCTAAGTTCTACAGACTATGTTTCCACATCTGCAGTACCCCTCTTGATACGCAATAT",
				results);
		}

		TEST_METHOD(TestReverseComplement_EColi)
		{
			size_t length;
			auto sequence = readTextDataFile("E_coli.txt", &length);
			auto expected = readTextDataFile("E_coli_revcomp.txt");
			auto results = reverseComplement(sequence, nullptr, length);
			//writeToClipboard(results);
			Assert::AreEqual(expected, results);
		}

		TEST_METHOD(TestReverseComplement_EColi_Times_10)
		{
			size_t length;
			auto sequence = readTextDataFile("E_coli_Times_10.txt", &length);
			auto expected = readTextDataFile("E_coli_times_10_revcmp.txt");
			auto results = reverseComplement(sequence, nullptr, length);
			//writeToClipboard(results);
			Assert::AreEqual(expected, results);
		}

	};
}